# 员工离职流程日志模拟器

这是一个全面的员工离职流程信息系统移交与销户子流程的日志模拟器，专门用于模拟和监控企业级员工离职过程中的各个环节，重点关注账号移交、销户合规性以及违规访问检测。

## 🎯 核心关注问题

1. **离职所有相关账号是否已正确按要求移交并销户**
2. **离职员工是否存在限期后的违规系统访问**

## 📊 数据概况

### 半结构化操作日志
- **日均数据行**: 50万条
- **数据源**: 各信息系统的操作日志

### 结构化操作记录  
- **日均数据行**: 1万条（按用户账号集合检索）
- **数据源**: 处理后的结构化数据

## ⚡ 性能需求

### 全量提取（需求1）
- **提取量**: 100万行记录（一个季度数据）
- **性能要求**: 15分钟内完成

### 增量同步（需求2）
- **同步频率**: 10分钟一次
- **数据简述**: 10分钟内相关账号的新增记录；新离职员工近一个季度相关记录
- **同步数据量**: 0-5000条
- **性能要求**: 15秒内完成

## 🏗️ 系统架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   HR系统模拟器   │    │ 访问监控模拟器   │    │ 数据同步模拟器   │
│                │    │                │    │                │
│ • 员工管理      │    │ • 访问日志生成   │    │ • 全量提取      │
│ • 离职流程      │    │ • 违规检测      │    │ • 增量同步      │
│ • 账号移交      │    │ • 合规监控      │    │ • 性能监控      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │   日志管理器     │
                    │                │
                    │ • 分类日志输出   │
                    │ • 格式化记录     │
                    │ • 文件管理      │
                    └─────────────────┘
```

## 📁 项目结构

```
ub-generator/
├── config.py                 # 配置文件
├── main.py                   # 主程序入口
├── requirements.txt          # 依赖包列表
├── README.md                # 项目说明
├── models/                  # 数据模型
│   └── employee.py          # 员工、账号、日志模型
├── simulators/              # 模拟器模块
│   ├── hr_system.py         # HR系统模拟器
│   ├── access_monitor.py    # 访问监控模拟器
│   └── data_sync.py         # 数据同步模拟器
├── utils/                   # 工具类
│   └── logger.py            # 日志管理器
└── logs/                    # 日志输出目录
    ├── hr_database.log      # HR数据库操作日志
    ├── system_access.log    # 系统访问日志
    ├── data_collection.log  # 数据采集日志
    ├── data_sync.log        # 数据同步日志
    ├── audit_monitor.log    # 审计监控日志
    ├── account_management.log # 账号管理日志
    ├── violation_alert.log  # 违规访问告警日志
    ├── performance.log      # 性能监控日志
    ├── error.log           # 错误日志
    └── main.log            # 主要运行日志
```

## 🚀 安装和运行

### 环境要求
- Python 3.7+
- 操作系统: Windows/Linux/MacOS

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行模拟器
```bash
python main.py
```

## 📝 日志文件说明

### 1. hr_database.log
HR系统数据库操作日志，JSON格式记录：
- 员工入职/离职操作
- 账号创建/禁用
- 权限变更记录

### 2. system_access.log  
系统访问日志，JSON格式记录：
- 用户登录/登出
- 系统资源访问
- 操作结果状态

### 3. audit_monitor.log
审计监控日志，JSON格式记录：
- 违规访问事件
- 合规性检查结果
- 风险等级评估

### 4. data_sync.log
数据同步操作日志：
- 全量/增量同步状态
- 同步数据量统计
- 性能指标记录

### 5. violation_alert.log
违规访问告警日志：
- 离职后账号访问
- 异常时间/地点访问
- 越权操作记录

### 6. performance.log
性能监控日志：
- 操作耗时统计
- 性能目标达成情况
- 系统瓶颈分析

## 🔧 配置说明

### 数据规模配置 (config.py)
```python
DATA_CONFIG = {
    "daily_log_rows": 500000,      # 日均数据行
    "daily_structured_rows": 10000, # 日均结构化数据
    "quarterly_total_rows": 1000000, # 季度总数据
    "incremental_sync_max": 5000,   # 增量同步最大数据量
}
```

### 性能要求配置
```python
PERFORMANCE_CONFIG = {
    "full_extract_time_limit": 900,    # 全量提取时间限制(秒)
    "incremental_sync_time_limit": 15, # 增量同步时间限制(秒)
    "sync_frequency_minutes": 10,      # 同步频率(分钟)
}
```

### 模拟参数配置
```python
SIMULATION_CONFIG = {
    "total_employees": 1000,        # 总员工数
    "resignation_rate": 0.02,       # 月离职率
    "violation_rate": 0.05,         # 违规访问概率
    "system_downtime_rate": 0.01,   # 系统故障率
}
```

## 🔍 监控功能

### 1. 账号移交监控
- ✅ 离职账号移交状态跟踪
- ✅ 移交记录完整性检查
- ✅ 移交成功率统计

### 2. 违规访问检测
- ✅ 离职后账号访问检测
- ✅ 异常时间访问监控
- ✅ 越权操作识别
- ✅ 风险等级评估

### 3. 合规性检查
- ✅ 账号禁用及时性
- ✅ 权限撤销完整性
- ✅ 数据移交规范性

### 4. 性能监控
- ✅ 数据同步性能
- ✅ 查询响应时间
- ✅ 系统吞吐量

## 📈 输出报告

### 统计报告内容
- HR系统运行统计
- 违规访问情况汇总
- 数据同步性能报告
- 系统健康度评估

### 健康度评估指标
- 移交成功率 (目标: ≥95%)
- 高风险告警数量
- 待处理告警数量
- 整体健康度得分

## 🛠️ 扩展功能

### 自定义配置
可以通过修改 `config.py` 调整：
- 员工规模和离职率
- 系统数量和类型
- 违规检测敏感度
- 性能指标阈值

### 新增监控规则
在 `access_monitor.py` 中可以添加：
- 新的违规检测规则
- 自定义风险评估逻辑
- 额外的合规性检查

### 日志格式定制
在 `logger.py` 中可以修改：
- 日志输出格式
- 文件命名规则
- 日志轮转策略

## 🎯 使用场景

1. **离职流程合规性审计**
2. **信息安全风险评估**
3. **数据同步性能测试**
4. **系统监控规则验证**
5. **合规制度流程优化**

## 🔄 持续运行

模拟器支持持续运行模式：
- 定时增量同步 (每10分钟)
- 实时违规检测
- 动态数据生成
- 自动统计报告

按 `Ctrl+C` 可优雅停止模拟器。

## ⚠️ 注意事项

1. 首次运行会自动创建 `logs/` 和 `data/` 目录
2. 日志文件会持续增长，建议定期清理
3. 模拟数据为随机生成，仅用于测试目的
4. 性能指标基于模拟环境，实际部署需要调整
5. 违规检测规则可根据实际安全策略定制

## 📞 技术支持

如有问题或建议，请参考日志文件中的错误信息进行排查，或查看 `error.log` 获取详细的异常信息。